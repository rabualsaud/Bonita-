<!doctype html>
<!--[if lt IE 7]>
<html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>
<html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>
<html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js"> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <title>Explorer</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" href="css/animate.css" />
    <link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="css/main.css">
	<link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/ng-modal.css">
	<link rel="stylesheet" href="css/angular-material.min.css"> 
	 
<!--  for the autocomplete -->
<link rel="stylesheet" href="css/angular-material.min.css"> 
		
<style>
.Loading {
    display: inline-block;
    vertical-align: middle;
    background-position: center;
    background:no-repeat;
    background-image: url('data:image/gif;base64,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');
    width:20px;
    height:20px;
    margin-top:6px;
    margin-right:7px;
}
.AutocompleteDropDown {
	background-color: #fcf8e3;
	}
</style>

		
</head>
<body ng-app="explorermonitorapp">
<!-- Show the directory currently used - remove it on a production server to not display the internal disk structure -->
<!--  Page Directory: @_PAGEDIRECTORY_@ -->

<div class="component col-xs-12"  ng-controller="ExplorerControler as ctrl">
		
	<div ng-if="ctrl.parameter.showbanner !=='Hide' ">
		<center>
		<table><tr><td><h1>Explorer</h1></td><td rowspan="2"><img src="img/icebreaker.jpg" width="150" heigth="150" /></td></tr>
			<tr><td>
				<center>
					V1.0.3 (Nov 5, 2020)
				</center>
			</td></tr>
			<tr><td>
			
			</td></tr>
		</table>
		</center>
	</div>

	<ul class="nav nav-tabs"  ng-class="{'nav-stacked': vertical, 'nav-justified': justified}" style="border-bottom: 1px solid #c2c2c2;">
		<!-- <li ng-class="{active: active, disabled: false}" id="form-tab" heading="All" active="true" title="Tasks" 
			select="ctrl.navbaractiv == 'Tasks'" class="{{ctrl.getNavClass('Tasks')}}" style="{{ctrl.getNavStyle('Tasks')}}">
			  <a ng-click="ctrl.navbaractiv = 'Tasks';"   class="ng-binding">Tasks</a>
		</li>
		 -->
		<li ng-class="{active: active, disabled: false}" id="form-tab" heading="All" active="true" title="Cases" 
			select="ctrl.navbaractiv == 'Cases'" class="{{ctrl.getNavClass('Cases',ctrl.navbaractiv)}}" style="{{ctrl.getNavStyle('Cases',ctrl.navbaractiv)}}">
			  <a ng-click="ctrl.navbaractiv = 'Cases';"   class="ng-binding">Cases</a>
		</li>
		<li ng-if="ctrl.user.isadmin"  
			ng-class="{active: active, disabled: false}" id="form-tab" heading="Parameter" active="true" title="Parameters" 
				select="ctrl.navbaractiv == 'Parameters'" class="{{ctrl.getNavClass('Parameters',ctrl.navbaractiv)}}" style="{{ctrl.getNavStyle('Parameters',ctrl.navbaractiv)}}">
			  <a  ng-click="ctrl.navbaractiv='Parameters'" class="ng-binding">Parameters</a>
		</li>

	</ul>
		
		
	<!--  ************************************************************  -->	
	<!--  Tab Tasks		 										-->
	<!--  ************************************************************  -->		
	<!-- Keep it ng-show, else the file drop will not work ! -->	
	<div class="col-lg-12" ng-show="ctrl.navbaractiv == 'Tasks'">
		
	</div>
			
	<!--  ************************************************************  -->	
	<!--  Tab Cases		 										-->
	<!--  ************************************************************  -->		
	<!-- Keep it ng-show, else the file drop will not work ! -->	
	<div class="col-lg-12" ng-show="ctrl.navbaractiv == 'Cases'">
		<br>
		<table style="width:100%">
		<tr>
			<td style="vertical-align: top;" ng-if="ctrl.casegui.showsearchpanel">
				<div class="panel panel-default">
					<div class="panel-heading">
						<a href="" ng-click="ctrl.casegui.showfilters = ! ctrl.casegui.showfilters"><div class="glyphicon glyphicon-chevron-down" ng-show="ctrl.casegui.showfilters"></div></a>
						<a href="" ng-click="ctrl.casegui.showfilters = ! ctrl.casegui.showfilters"><div class="glyphicon glyphicon-chevron-right" ng-show="! ctrl.casegui.showfilters"></div></a>
					Filters</div>
					<div class="panel panel-body" ng-if="ctrl.casegui.showfilters">
					
						<div class="form-group row" ng-if="ctrl.user.isadmin">
							<label for="example-datetime-local-input" class="col-sm-1 col-form-label">Visibility</label>
							 <div class="col-sm-5">
							 	<select ng-model="ctrl.searchcases.visibility" type="number" title="Year" class="form-control form-control-sm" >
							 		<option value="user">As a user</option>
							 		<option value="admin">As an admin</option>
								</select>
							</div>
						</div>
						<div class="form-group row">
							<label for="example-datetime-local-input" class="col-sm-1 col-form-label">Origin</label>
							<div class="col-sm-2">
								<input ng-model="ctrl.searchcases.opencase" type="checkbox" title="Search in open case" class="form-check-input " >Open cases
							</div>
							<div class="col-sm-2">
								<input ng-model="ctrl.searchcases.archivedcase" type="checkbox" title="Search in archived case" class="form-check-input" style="padding: 10px 15px;">Archived cases
							</div>
							<div class="col-sm-3" ng-if="ctrl.showExternalOrigin()">
								<input ng-model="ctrl.searchcases.externalcase" type="checkbox" title="Search in an external database" class="form-check-input" style="padding: 10px 15px;">External Archive database
							</div>
							<div class="col-sm-4" style="float: right">
									<button ng-click="ctrl.resetCaseFilter()" class="btn btn-primary btn-xs" ng-disabled="ctrl.inprogress">Clear filters</button>&nbsp;		
									<button ng-click="ctrl.saveCaseFilter()" class="btn btn-info btn-xs" ng-disabled="ctrl.inprogress">Save Filter as Default</button>&nbsp;
									<button ng-click="ctrl.loadCaseFilter()" class="btn btn-info btn-xs" ng-disabled="ctrl.inprogress">Load Default Filter</button>		<br>
									 <div ng-bind-html="ctrl.getListEvents(ctrl.listeventssavesearchcase)"></div>
							</div>
						</div>
						<div class="form-group row">
							<label for="example-datetime-local-input" class="col-sm-1 col-form-label">Process</label>							
							<div class="col-sm-5">
								<div ng-if="ctrl.parameter.filtreprocessdisplay === 'list'">
									<select ng-model="ctrl.searchcases.processname" >
							 			<option ng-repeat="item in ctrl.listprocessesname" value="{{item}}">{{item}}</option>
						 			</select>
									 
								</div>
								<div ng-if="ctrl.parameter.filtreprocessdisplay === 'autocomplete'">
									<md-autocomplete md-selected-item="ctrl.searchcases.processname" 
										md-search-text="ctrl.searchcases.searchprocessuser" 
										md-items="item in ctrl.query('queryprocess', ctrl.searchcases.searchprocessuser )" 
										md-item-text="item.display" md-delay="500"
									 	md-floating-label="Process"
					    				md-clear-button="false" 
					    				style="width:300px" 
					    				md-menu-class="AutocompleteDropDown">
									  	<span md-highlight-text="ctrl.autocomplete.listprocesses">{{item.display}}</span>
									</md-autocomplete>
								</div>
								<!-- 							
								<input ng-model="ctrl.searchcases.processname"  title="" class="form-control form-control-sm" > -->
							</div>
						</div>
						<!--  bob -->
						<div class="form-group row">
							<label for="example-datetime-local-input" class="col-sm-1 col-form-label">Search Key</label>
							<div class="col-sm-5"><input ng-model="ctrl.searchcases.searchkey"  title="Search in indexes" class="form-control form-control-sm" ></div>

							<label for="example-datetime-local-input" class="col-sm-1 col-form-label">Case ID</label>
							<div class="col-sm-5"><input ng-model="ctrl.searchcases.caseid" type="number"  title="" class="form-control form-control-sm" ></div>
						</div>
						<div class="form-group row">
							<div ng-if="ctrl.parameter.showstartdate ==='true'">
						
								<label for="example-datetime-local-input" class="col-sm-1 col-form-label">Start date</label>
								
								<div class="col-sm-2" ng-if="ctrl.parameter.datewithtime">
									<input ng-model="ctrl.searchcases.startdatebeg" type="datetime-local" ng-if="ctrl.parameter.datewithtime === 'true' " title="" class="form-control form-control-sm"> 
									<input ng-model="ctrl.searchcases.startdatebeg" type="date" title=""  ng-if="ctrl.parameter.datewithtime !== 'true'" class="form-control form-control-sm"> 
								</div>
								<div class="col-sm-1">To</div>
								
								<div class="col-sm-2">
									<input ng-model="ctrl.searchcases.startdateend" type="datetime-local" ng-if="ctrl.parameter.datewithtime === 'true' " title="" class="form-control form-control-sm">
									<input ng-model="ctrl.searchcases.startdateend" type="date" ng-if="ctrl.parameter.datewithtime !== 'true' " title="" class="form-control form-control-sm">
								</div>
							</div>
							<div ng-if="ctrl.parameter.showenddate === 'true'">
								<label for="example-datetime-local-input" class="col-sm-1 col-form-label">End date</label>
								<div class="col-sm-2">
									<input ng-model="ctrl.searchcases.enddatebeg" type="datetime-local" ng-if="ctrl.parameter.datewithtime === 'true' " title="" class="form-control form-control-sm">							
									<input ng-model="ctrl.searchcases.enddatebeg" type="date" ng-if="ctrl.parameter.datewithtime !== 'true' " title="" class="form-control form-control-sm">
								</div>							
								<div class="col-sm-1">To</div>
								<div class="col-sm-2">
									<input ng-model="ctrl.searchcases.enddateend" type="datetime-local"  ng-if="ctrl.parameter.datewithtime === 'true' " title="" class="form-control form-control-sm">
									<input ng-model="ctrl.searchcases.enddateend" type="date"  ng-if="ctrl.parameter.datewithtime !== 'true' " title="" class="form-control form-control-sm">
								</div>
							</div>
						</div>
						<div class="form-group row" ng-if="ctrl.parameter.datewithtime == 'true'">
						 	<label class="col-sm-1"></label>
							<div class="col-sm-11">
								<center>
									<div class="badge badge-secondary" width="100%">Attention, gives a complete date PLUS TIME to have a valid date. Example, 12-02-2020 is invalid because you miss hours.</div>
								</center>
							</div>
						</div>
													
						<div class="form-group row">
							<div class="col-sm-1"></div>
							<div class="col-sm-6">
									<button ng-click="ctrl.searchCases()" class="btn btn-info" ng-disabled="ctrl.inprogress">Search</button>		
									&nbsp;&nbsp;&nbsp;
									<div ng-if="ctrl.inprogress">
										<span class="Loading">.</span>
									</div>
							</div>
							
						</div>
						<div class="form-group row">
							<div class="col-sm-4">
								Cases on the page:	<select ng-model="ctrl.searchcases.caseperpages" >
						 				<option id="25">25</option>
						 				<option id="50">50</option>
						 				<option id="100">100</option>
						 				<option id="500">500</option>
								</select>
							</div>
							<div class="col-sm-4">
								Order by:	<select ng-model="ctrl.searchcases.orderby" >
						 				<option value="origin">Origin</option>
						 				<option value="caseid">Case ID</option>
						 				<option value="processname">Process</option>
						 				<option value="startdate">Start date</option>
						 				<option value="enddate">End date</option>
						 				<option value="stringindex1">Search Key 1</option>
						 				<option value="stringindex2">Search Key 2</option>
						 				<option value="stringindex3">Search Key 3</option>
						 				<option value="stringindex4">Search Key 4</option>
						 				<option value="stringindex5">Search Key 5</option>
								</select>
								<select ng-model="ctrl.searchcases.orderdirection" >
						 				<option value="asc">Ascendant</option>
						 				<option value="desc">Descendant</option>
								</select>
								
							</div>
						</div>
					</div>

				</div> <!--  end filter -->
				
				
				<table width="100%">
					<tr>
						<td >
							{{ctrl.cases.first}}-{{ctrl.cases.last}} of {{ctrl.cases.count}}</div>
						</td>
						<td style="text-align:right;padding-right:40px" >
						 	<div ng-show="ctrl.showPagination()">
						 
								<!-- pagination -->
								<!--  https://angular-ui.github.io/bootstrap/versioned-docs/1.2.1/ -->
								<pagination ng-model="ctrl.searchcases.pagenumber" 
									total-items="ctrl.cases.count" 
									items-per-page="ctrl.searchcases.caseperpages"
									ng-click="ctrl.refresh()"
									boundary-links="true" 
									max-size="5"
									boundary-link-numbers="true"
									rotate="true"
									force-ellipses="true"
									ng-disabled="ctrl.wait">
								</pagination>						
							</div>
							<div ng-show="! ctrl.showPagination()">
						 		<div class="badge badge-secondary" width="100%">Pagination is active when one orign is selected</div>
							</div>			
						</td>
					</tr>					
				</table>
			
			
			
				<table class="table table-striped table-hover table-condensed">
					<tr> 
						<th ng-show="ctrl.parameter.showColumns.origin">Origin</th>
						<th>Case ID</th>
						<th ng-show="ctrl.parameter.showColumns.process" >Process</th>
						<th ng-show="ctrl.parameter.showColumns.startdate" >Start date</th>
						<th ng-show="ctrl.parameter.showColumns.startedby" >Started by</th>
						<th ng-show="ctrl.parameter.showColumns.enddate" >End date</th>
						<th ng-show="ctrl.parameter.showColumns.searchbykey1" >Search Key 1</th>
						<th ng-show="ctrl.parameter.showColumns.searchbykey2" >Search Key 2</th>
						<th ng-show="ctrl.parameter.showColumns.searchbykey3" >Search Key 3</th>
						<th ng-show="ctrl.parameter.showColumns.searchbykey4" >Search Key 4</th>
						<th ng-show="ctrl.parameter.showColumns.searchbykey5" >Search Key 5</th>
						<th></th>
					</tr>
					<tbody ng-repeat="case in ctrl.cases.list">
						<tr>
							<td ng-show="ctrl.parameter.showColumns.origin"	>{{case.origin}}</td>
							<td												><a ng-click="ctrl.showCaseOverview( case )">{{case.caseid}}</a></td>
							<td ng-show="ctrl.parameter.showColumns.process"><div title="{{case.processname}} ({{case.processversion}})">{{case.processname}}</div></td>
							<td ng-show="ctrl.parameter.showColumns.startdate">{{case.startdatest}}</td>
							<td ng-show="ctrl.parameter.showColumns.startedby">{{case.startbyname}}</td>
							<td ng-show="ctrl.parameter.showColumns.enddate">{{case.enddatest}}</td>
							<td ng-show="ctrl.parameter.showColumns.searchbykey1" >{{case.stringindex1}}</td>
							<td ng-show="ctrl.parameter.showColumns.searchbykey2" >{{case.stringindex2}}</td>
							<td ng-show="ctrl.parameter.showColumns.searchbykey3" >{{case.stringindex3}}</td>
							<td ng-show="ctrl.parameter.showColumns.searchbykey4" >{{case.stringindex4}}</td>
							<td ng-show="ctrl.parameter.showColumns.searchbykey5" >{{case.stringindex5}}</td>
							<td>
								<a ng-click="ctrl.showCaseOverview( case )">
									<span class="glyphicon glyphicon-eye-open"></span></a>
							</td>
						</tr>
						
					</tbody>
				</table>	
				<span style="font-size:small" ng-if="ctrl.cases.totalchronos">Result in {{ctrl.cases.totalchronos}} ms</span>
		
		 </td>
		 <td style="border-left: 3px solid #194063;vertical-align: top;" >
				<!-- ov={{ctrl.casegui.showcasepanel}} / url={{ctrl.showcaseurl}} search={{ctrl.casegui.showsearchpanel}}-->
			<table>
				<tr><td>
				<a ng-click="ctrl.showCasePanel( false )" ng-if="ctrl.casegui.showcasepanel == true" title="Hide the Case Overview panel and show the filter"><span class="glyphicon glyphicon-chevron-right"></span> </a>
				<a ng-click="ctrl.showCasePanel( true )"  ng-if="ctrl.casegui.showcasepanel == false" title="Display the Case Overview panel"><span class="glyphicon glyphicon-chevron-left"></span> </a>	
				</td><td><div ng-if="ctrl.casegui.showcasepanel"><h3>Case overview {{ctrl.casegui.caseselected.caseid}}</h3></div></td>
				</tr>
				</table>
				
				<div ng-if="ctrl.casegui.showcasepanel">
					<ul class="nav nav-tabs"  ng-class="{'nav-stacked': vertical, 'nav-justified': justified}" style="border-bottom: 1px solid #c2c2c2;">
						<li ng-class="{active: active, disabled: false}" id="form-tab" heading="All" active="true" title="Cases" 
							select="ctrl.casegui.navbaractiv == 'Overview'" 
							class="{{ctrl.getNavClass('Overview', ctrl.casegui.navbaractiv)}}" 
							style="{{ctrl.getNavStyle('Overview', ctrl.casegui.navbaractiv)}}">
		  						<a ng-click="ctrl.casegui.navbaractiv = 'Overview';"   class="ng-binding">Form</a>
						</li>
						<li ng-if="ctrl.user.isadmin" ng-class="{active: active, disabled: false}" id="form-tab" heading="All" active="true" title="Cases" 
							select="ctrl.casegui.navbaractiv == 'Tasks'" 
							class="{{ctrl.getNavClass('Tasks', ctrl.casegui.navbaractiv)}}" 
							style="{{ctrl.getNavStyle('Tasks', ctrl.casegui.navbaractiv)}}">
		  						<a ng-click="ctrl.casegui.navbaractiv = 'Tasks';"   class="ng-binding">Tasks</a>
						</li>
						<li ng-class="{active: active, disabled: false}" id="form-tab" heading="All" active="true" title="Cases" 
							select="ctrl.casegui.navbaractiv == 'Comments'" 
							class="{{ctrl.getNavClass('Comments', ctrl.casegui.navbaractiv)}}" 
							style="{{ctrl.getNavStyle('Comments', ctrl.casegui.navbaractiv)}}">
		  						<a ng-click="ctrl.casegui.navbaractiv = 'Comments';"   class="ng-binding">Comments</a>
						</li>
					</ul>
					
					<!--  ************************************************************  -->	
					<!--  Panel Overview -->	
					
					<div ng-if="ctrl.casegui.navbaractiv == 'Overview'">
						<!--  showcaseurl={{ctrl.casegui.showcaseurl}} showcaseexturl={{ctrl.casegui.ctrl.casegui.showcaseexturl}} -->
						<div class="CaseViewer Viewer-wrapper ng-isolate-scope" height="100%" ng-if="ctrl.casegui.showcaseurl">
							<!--  <a ng-href="ctrl.casegui.showcaseurl" target="top">Open in a new tab</a> -->
							<iframe src="{{ctrl.casegui.showcaseurl}}" width="100%" height="100%" style="border: none;" title="Case overview" id="icaseoverview" onLoad="onLoadIFrame()"
									sandbox="allow-same-origin allow-scripts allow-popups allow-forms"></iframe>
																
						</div>
						<div class="CaseViewer Viewer-wrapper ng-isolate-scope" height="100%" ng-if="ctrl.casegui.showcaseexturl">
							<p>
							<center>
								<h3><a href="{{ctrl.casegui.showcaseexturl}}" target="top">Open in a new tab</a></h3>
							</center>
							<!-- 
							<iframe src="{{ctrl.casegui.caseexturlcontent}}" width="100%" height="100%" style="border: none;" title="Case overview" id="icaseoverview" onLoad="onLoadIFrame()"
									sandbox="allow-same-origin allow-scripts allow-popups allow-forms"></iframe>
									 -->
						</div>
						<div class="CaseViewer Viewer-wrapper ng-isolate-scope" height="100%" ng-if="ctrl.casegui.showcaseurl == null && ctrl.casegui.showcaseexturl==null">
							<!--  Loop on case -->
							<div ng-repeat="case in ctrl.casegui.externalcase">
								<div class="alert alert-info">Case {{case.caseid}}
									<div ng-if="case.typeprocessinstance === 'root'">
										</i>Started {{case.startdatest}}, Ended {{case.enddatest}}
										Started by {{case.startedbyname}} {{case.startedbysubstitutename}}</i>
									</div>
									<div ng-if="case.typeprocessinstance === 'subprocess'">
										Subprocess
									</div>
								</div>
								<!--  variable -->
								<div class="form-group row" ng-repeat="variable in case.variables">
									<label for="example-datetime-local-input" class="col-sm-2 col-form-label">{{variable.name}}</label>								
								 	<div class="col-sm-10">
								 		<div ng-if="variable.bdmname">BDM <i>{{variable.bdmname}}</i></div>
								 	<input readonly ng-model="variable.value" class="form-control form-control-sm" ></div>
								</div>
								<!--  Documents -->
								<div class="form-group row" ng-repeat="doc in case.documents">
									<label for="example-datetime-local-input" class="col-sm-2 col-form-label">{{doc.name}}</label>								
								 	<div class="col-sm-10">
								 		<div ng-if="doc.type =='doc'">
								 			<table><tr><td style="padding: 10px;">
									 			<center>
									 		 	<div ng-if="doc.hascontent">
									 		 	
									 				<a href="{{ctrl.downloadCaseDocument( doc )}}" title="{{doc.author}}">
									 					<span class="glyphicon glyphicon-file"></span><br>
									 					{{doc.filename}}
									 				</a>
									 			</div>
									 			<div ng-if="! doc.hascontent">
									 				<a href="{{doc.url}}" title="{{doc.author}}">{{doc.url}}</a>
									 			</div>
									 			</center>
									 		</td></tr></table>
								 		</div>
								 		<div ng-if="doc.type =='list'">
								 			<table><tr><td ng-repeat="docitem in doc.value" style="padding: 10px;">
								 				<center>
								 				<div ng-if="docitem.hascontent">
									 				<a href="{{ctrl.downloadCaseDocument( docitem )}}" title="{{docitem.author}}">
									 					<span class="glyphicon glyphicon-file"></span><br>
									 					{{docitem.filename}}
									 				</a>
									 			</div>
									 			<div ng-if="! docitem.hascontent">
									 				<a href="{{docitem.url}}" title="{{docitem.author}}">{{docitem.url}}</a>
									 			</div>
								 				</center>
								 			</td></tr></table>
								 		</div>
	
									</div>
								</div>
							</div> 
						</div>
					</div> <!--  end caseoveriew -->
					
					<!--  ************************************************************  -->	
					<!--  Panel Tasks of a case -->	
					
					<div ng-if="ctrl.casegui.navbaractiv == 'Tasks'">
						<h4>Tasks</h4>
						<table>
							<tr><th></th><th>Name</th><th>Type</th><th>Executed</th></tr>
							<tr ng_repeat="task in ctrl.casegui.tasks">
								<td style="padding: 10px 15px;">
									<img ng-if="task.kind=='AUTOMATIC_TASK'" src="/bonita/theme/themeResource?theme=portal&location=skin/images/metadata_automaticTask_small.png"></img>
									<img ng-if="task.kind=='CALL_ACTIVITY'" src="/bonita/theme/themeResource?theme=portal&location=skin/images/metadata_callactivity_small.png"></img>
									<img ng-if="task.kind=='USER_TASK'" src="/bonita/theme/themeResource?theme=portal&location=skin/images/metadata-user.png"></img>
									<img ng-if="task.kind=='LOOP_ACTIVITY'" src="/bonita/theme/themeResource?theme=portal&location=skin/images/metadata_loop_task.png"></img>
									<img ng-if="task.kind=='MULTI_INSTANCE_ACTIVITY'" src="/bonita/theme/themeResource?theme=portal&location=skin/images/metadata_multi_instance_task.png"></img>
								</td>
								<td style="padding: 10px 15px;">
									<span style="font-weight: bold;">Task Name:</span> {{task.displayname}}<br>
									<span style="font-weight: bold;">Task:</span> {{task.name}}<br>
								</td>
								<td style="padding: 10px 15px;">
									<span style="font-weight: bold;">Executed by:</span> {{task.executedbyname}}<br>
									<span style="font-weight: bold;"><span class="glyphicon glyphicon-calendar"></span>Performed on:</span> {{task.enddatest}}
							</tr>
						</table>
					</div>
					
					<!--  ************************************************************  -->	
					<!--  Panel Comments -->	
					<div ng-if="ctrl.casegui.navbaractiv == 'Comments'">
						<h4>Comments</h4>
						<table>
							
							<tbody ng_repeat="comment in ctrl.casegui.comments">
								<tr>
									<td style="padding: 10px 15px;border-radius: 5px;border: 2px solid #c2c2c2;min-height: 45px;">{{comment.content}}</td>
									<td style="padding: 10px 15px;"><i>By {{comment.userbyname}}</i></td>
									<td style="padding: 10px 15px;"><i>On {{comment.enddatest}}</i></td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
				 
			</td>
		</table>	
	</div>
	<!--  ************************************************************  -->	
	<!--  Tab Parameters		 										-->
	<!--  ************************************************************  -->		
	<!-- Keep it ng-show, else the file drop will not work ! -->	
	<div class="col-lg-12" ng-show="ctrl.navbaractiv == 'Parameters'">
	
		<div class="panel panel-info">
			<div class="panel-heading">
				Source 
			</div>
			<div class="panel panel-body" >
				<div class="form-group row">
					<label for="example-datetime-local-input" class="col-sm-2 col-form-label">Type</label>
					<div class="col-sm-10">
						<select ng-model="ctrl.parameter.typedatasource"  title="Type" class="form-control form-control-sm" >
							 		<option value="NOEXTERNALARCHIVE">No External source</option>
							 		<option value="EXTERNAL">External source</option>
							 		<option value="BONITASERVER">External Bonita Server</option>
								</select>
					</div>
					An "External source" is a source generated by the TruckMilk "Move case Archive" jobs. An external database is then poplated with cases.<br>
					An "External Bonita Server" is an another Bonita server (not a node in the same cluster), where you have cases.
				</div>
			
				<div class="form-group row" ng-if="ctrl.parameter.typedatasource !== 'NOEXTERNALARCHIVE'">
					<label for="example-datetime-local-input" class="col-sm-2 col-form-label">Data Source</label>
					<div class="col-sm-10">
						<input ng-model="ctrl.parameter.datasource"  class="form-check-input " >
					</div>
				</div>
				
				<div class="form-group row" ng-if="ctrl.parameter.typedatasource == 'BONITASERVER'">
					<label for="example-datetime-local-input" class="col-sm-2 col-form-label">Bonita Serveur URL</label>
					<div class="col-sm-10">
						<input ng-model="ctrl.parameter.bonitaserverurl"  class="form-check-input " >
					</div>
				</div>
				
				<div class="form-group row" ng-if="ctrl.parameter.typedatasource == 'EXTERNAL'">
					<label class="col-sm-2 col-form-label">Overview for case (In case of External source])</label>
					 <div class="col-sm-10">
					 	<select ng-model="ctrl.parameter.overviewpolicy" >
						 	<option value="display">Display variable</option>
						 	<option value="processoverview">Use process overview</option>
					 	</select><br>
					 	Attention: if you select the Use Process Overview policy, you must install the Explorer Filter.
					 </div>
				</div>
				<!-- 
				<div class="form-group row">
					<label for="example-datetime-local-input" class="col-sm-2 col-form-label">Show Case Filter</label>
					 <div class="col-sm-10">
					 	<select ng-model="ctrl.parameter.showcasefilter" >
						 	<option id="open">Open Every time</option>
						 	<option id="open">Close Every time</option>
						 	<option id="open">Open only if empty</option>
					 	</select>
					 </div>
				</div>
				 -->
		 	</div>
		</div>
		<div class="panel panel-info">
			<div class="panel-heading">
				Filter 		
			</div>
			<div class="panel panel-body" >
			
				<div class="form-group row">
					<label for="example-datetime-local-input" class="col-sm-2 col-form-label">Process</label>
					 <div class="col-sm-10">
					 	<select ng-model="ctrl.parameter.filtreprocessdisplay" >
						 	<option value="list">List</option>
						 	<option value="autocomplete">Auto complete</option>
					 	</select>
					 </div>			 
					 Attention, do not choose a list if you have more than 1000 processes
				</div>
				<div class="form-group row">
					<label for="example-datetime-local-input" class="col-sm-2 col-form-label">Start date criteria</label>
					<div class="col-sm-10">
					 	<select ng-model="ctrl.parameter.showstartdate" >
						 	<option value="true">Show</option>
						 	<option value="false">Hide</option>
					 	</select>
					 </div>			 
				</div>
				<div class="form-group row">
					<label for="example-datetime-local-input" class="col-sm-2 col-form-label">End date criteria</label>
					 <div class="col-sm-10">
					 	<select ng-model="ctrl.parameter.showenddate" >
						 	<option value="true">Show</option>
						 	<option value="false">Hide</option>
					 	</select>
					 </div>			 
				</div>
				
				
				<div class="form-group row">
					<label for="example-datetime-local-input" class="col-sm-2 col-form-label">Filter Dates with hour</label>
					 <div class="col-sm-10">
					 	<select ng-model="ctrl.parameter.datewithtime" >
						 	<option value="true">Date and hour</option>
						 	<option value="false">Without hours, only date</option>
					 	</select>
					 </div>
				</div>
					<!--  bryan -->		
				<div class="form-group row">
					<label for="example-datetime-local-input" class="col-sm-2 col-form-label">Columns visible</label>
					<div class="col-sm-1">	<input type="checkbox" ng-model="ctrl.parameter.showColumns.origin">Origin</div>
					<div class="col-sm-1">	<input type="checkbox" ng-model="ctrl.parameter.showColumns.caseid" ng-disabled="true">CaseId</div>
					<div class="col-sm-1">	<input type="checkbox" ng-model="ctrl.parameter.showColumns.process">Process</div>
					<div class="col-sm-1">	<input type="checkbox" ng-model="ctrl.parameter.showColumns.startdate">Start date</div>
					<div class="col-sm-1">	<input type="checkbox" ng-model="ctrl.parameter.showColumns.startedby">Started by</div>
					<div class="col-sm-1">	<input type="checkbox" ng-model="ctrl.parameter.showColumns.enddate">End date</div>
				</div>
				<div class="form-group row">
					<label for="example-datetime-local-input" class="col-sm-2 col-form-label">Search key visible</label>
				
					<div class="col-sm-1">	<input type="checkbox" ng-model="ctrl.parameter.showColumns.searchbykey1">Key 1</div>
					<div class="col-sm-1">	<input type="checkbox" ng-model="ctrl.parameter.showColumns.searchbykey2">Key 2</div>
					<div class="col-sm-1">	<input type="checkbox" ng-model="ctrl.parameter.showColumns.searchbykey3">Key 3</div>
					<div class="col-sm-1">	<input type="checkbox" ng-model="ctrl.parameter.showColumns.searchbykey4">Key 4</div>
					<div class="col-sm-1">	<input type="checkbox" ng-model="ctrl.parameter.showColumns.searchbykey5">Key 5</div>
				</div>
			</div>
		</div>
	
		<div class="panel panel-info">
			<div class="panel-heading">
				Interface 		
			</div>
			<div class="panel panel-body" >	
				<div class="form-group row">
					<label for="example-datetime-local-input" class="col-sm-2 col-form-label">Banner</label>
					 <div class="col-sm-10">
					 	<select ng-model="ctrl.parameter.showbanner" >
						 	<option value="Show">Show</option>
						 	<option value="Hide">Hide</option>
					 	</select>
					 </div>			 
				</div>		
			</div>
		</div>		
		
		<button ng-click="ctrl.saveParameters()" class="btn btn-info btn-xs" ng-disabled="ctrl.inprogress">Save Parameters</button>		
							&nbsp;&nbsp;&nbsp;
		<div ng-if="ctrl.inprogress">
			<span class="Loading">.</span>
		</div>
		<div ng-bind-html="ctrl.getListEvents(ctrl.listeventssavesearchcase)"></div>
				
	</div>
</div>		

<script>
function onLoadIFrame() {
	console.log("OnLoadIframeScript");
	// Adjusting the iframe height onload event
    var iframes = document.querySelectorAll("iframe");
    for( var i = 0; i < iframes.length; i++) {
    	var height=iframes[ i ].contentWindow.document.body.scrollHeight;
    	height+= 20;
    	console.log("OnLoadIframeScript: Found a Iframe, size="+iframes[ i ].contentWindow.document.body.scrollHeight+" set heigh="+height);
        iframes[ i ].style.height = height + 'px';


    }

}
</script>

<!-- Third party dependencies -->

<script src="3rd-party/jquery.min.js"></script>

<script src="3rd-party/angular.min.js"></script>

<script src="3rd-party/angular-resource.min.js"></script>
<script src="3rd-party/angular-cookies.min.js"></script>
<script src="3rd-party/bootstrap/js/bootstrap.min.js"></script>
<script src="3rd-party/angular-bootstrap-tpls.min.js"></script>
<script src="3rd-party/angular-sanitize.min.js"></script> 

<!--  Material -->  
<script src="3rd-party/angular-animate.min.js"></script>  
<script src="3rd-party/angular-aria.min.js"></script>  
<script src="3rd-party/angular-messages.min.js"></script>  
<script src="3rd-party/angular-material.min.js"></script>  





  

<!-- Application dependencies -->
<!-- to be sure to reload every time the JS file, add this marker -->
<script src="pageResource?page=custompage_explorer&location=explorermonitor.js&t=@_CURRENTTIMEMILIS_@"></script>




</body>
</html>		